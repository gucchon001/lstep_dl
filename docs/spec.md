# LINE公式アカウント データダウンロード自動化プログラム仕様書

## 1. 概要
本プログラムは、LINE公式アカウントの管理画面から会員データとアンケートデータを自動的にダウンロードし、指定されたGoogleスプレッドシートに転記するツールです。

## 2. 機能仕様

### 2.1 基本機能
- LINE公式アカウント管理画面への自動ログイン
- 会員データのCSVダウンロード
- アンケートデータのCSVダウンロード
- ダウンロードしたデータのGoogleスプレッドシートへの転記
- 操作ログの記録
- ダウンロードしたCSVファイルの自動削除

### 2.2 詳細仕様

#### 2.2.1 会員データダウンロード
1. 友達リストページへの遷移
2. CSV操作メニューの展開
3. CSVエクスポートページでの以下の項目選択：
   - 基本情報（名前、表示名、ニックネーム等）
   - ステータス情報
   - メッセージ履歴
   - シナリオ情報
   - 流入経路
   - タグ情報
4. エクスポート実行
5. ダウンロード完了待機（設定可能、デフォルト3分）
6. CSVファイルのダウンロード
7. スプレッドシートへの転記

#### 2.2.2 アンケートデータダウンロード
1. アンケートフォームページへの遷移
2. 回答一覧のダウンロード
3. ダウンロード完了待機（最大60秒）
4. スプレッドシートへの転記

### 2.3 設定項目
設定は `config/settings.ini` で管理

#### 2.3.1 基本設定
- LINE公式アカウントのログイン情報
- Googleスプレッドシートの設定
  - スプレッドシートID
  - シート名（会員データ用、アンケート用）

#### 2.3.2 待機時間設定
- エクスポート完了待機時間（秒）
- ページ遷移待機時間
- 操作間隔待機時間

### 2.4 エラー処理
- 各操作でのエラーをログに記録
- エラー発生時は処理を中断し、エラーメッセージを表示
- リトライ機能（ダウンロードボタンのクリック時）

## 3. 技術仕様

### 3.1 開発環境
- Python 3.x
- Selenium WebDriver
- Google Sheets API
- PyInstaller（実行ファイル作成用）

### 3.2 必要なライブラリ
- selenium
- google-api-python-client
- pandas
- pathlib
- logging

### 3.3 ファイル構成
├── src/
│ ├── main.py
│ ├── modules/
│ │ ├── browser.py
│ │ ├── csv_downloader.py
│ │ ├── login.py
│ │ ├── spreadsheet.py
│ │ └── log_spreadsheet.py
│ └── utils/
│ ├── environment.py
│ └── logging_config.py
├── config/
│ ├── settings.ini
│ └── selectors.csv
├── logs/
└── docs/
└── spec.md

## 4. 運用仕様

### 4.1 実行方法
1. 設定ファイル（settings.ini）の準備
2. Google Cloud Platformでの認証設定
3. 実行ファイル（.exe）の実行

### 4.2 エラー対応
- ログファイルを確認
- エラーメッセージに応じた対処
- 必要に応じて待機時間の調整

### 4.3 メンテナンス
- 定期的なログファイルの確認
- 設定値の最適化
- LINE公式アカウント管理画面の変更への対応

## 5. 制限事項
- Windows環境での動作を前提
- Chrome ブラウザが必要
- インターネット接続が必要
- Google Cloud Platform の認証情報が必要

