---
description: 
globs: **/spreadsheet*.py
alwaysApply: false
---
## スプレッドシートの認証ルール

- **認証情報の集中管理:**  
  スプレッドシートの認証に必要なサービスアカウントの情報は、環境変数や設定ファイル内で一元管理します。直接コード内に認証ファイルのパスをハードコーディングせず、必ずユーティリティクラス（例：`EnvironmentUtils`）を用いて取得してください。

- **環境変数の利用:**  
  認証情報は、外部設定ファイル（例えば、シークレット管理用のファイル）に記述され、環境変数として読み込まれます。これにより、具体的な認証ファイル名などの情報はコードに含めず、柔軟に変更可能な運用が実現されます。  

- **環境変数のロード:**  
  認証情報を利用する前に、必ず環境変数のロード処理（例：`EnvironmentUtils.load_env()`）を実行し、必要な変数が正しくセットアップされていることを確認します。

- **エラーハンドリング:**  
  認証情報の取得に失敗した場合は、明確なエラーメッセージをロギングするなど、ユーザーに設定ファイルや環境変数の確認を促す仕組みを実装してください。

- **セキュリティ対策:**  
  認証情報は機密情報であるため、コードリポジトリには含めず、外部のセキュリティ対策（例：設定ファイルのアクセス制限やシークレット管理システム）を利用して安全に管理してください。

- **認証設定:**  
  認証情報のファイルパスや関連する設定は、@secrets.env の`SERVICE_ACCOUNT_FILE`を必ず使って


  